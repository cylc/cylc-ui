/**
 * Copyright (C) NIWA & British Crown (Met Office) & Contributors.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

@use "sass:list";

/* css namespace for job element */
$cjob: ".c-job .job rect";

#{$cjob} {
    /* if no job status display nothing */
    fill: transparent;
    stroke: transparent;
}

.c-job .job {
    /* scale the icon to the font-size */
    width: 1em;
    height: 1em;
}

.task-state-badge {
    font-size: 0.7em;
    $height: 1.8em;
    height: $height;
    min-width: $height;
    border-radius: $height;
    border: 0.2em solid;
    margin: 0 0.1em;
    line-height: normal;
}

$teal: rgb(109,213,194);
$blue: rgb(106,164,241);
$green: rgb(81,175,81);
$red: rgb(207,72,72);
$pink: rgb(190,106,192);

$light: rgb(208,208,208);
$medium: rgb(133,133,133);
$dark: rgb(0,0,0);

$grey: rgb(152,152,152);
$success: rgb(108,218,255);
$error: rgb(146,0,0);

// Mapping of job themes to job states to (fill, outline, text) colors
$themes: (
    "default": (
        "submitted": ($teal, $teal, white),
        "running": ($blue, $blue, white),
        "succeeded": ($green, $green, white),
        "failed": ($red, $red, white),
        "submit-failed": ($pink, $pink, white),
    ),
    "greyscale": (
        "submitted": (transparent, $light, black),
        "running": ($light, $light, black),
        "succeeded": ($medium, $medium, white),
        "failed": ($dark, $dark, white),
        "submit-failed": (transparent, $dark, black),
    ),
    "colour_blind": (
        "submitted": (transparent, $grey, black),
        "running": ($grey, $grey, white),
        "succeeded": ($success, $success, black),
        "failed": ($error, $error, white),
        "submit-failed": (transparent, $error, black),
    ),
);

@each $theme, $state_map in $themes {
    .job_theme--#{$theme} {
        &, // job theme as configured by the top-level application
        &.job_theme_override {
            // if overridden elsewhere the new value should take priority
            // (this allows us to override the theme in the user profile)
            @each $state, $colors in $state_map {
                #{$cjob}.#{$state} {
                    fill: list.nth($colors, 1);
                    stroke: list.nth($colors, 2);
                }
                .task-state-badge.#{$state} {
                    background-color: list.nth($colors, 1);
                    border-color: list.nth($colors, 2);
                    color: list.nth($colors, 3);
                }
            }
        }
    }
}

.task-state-badge.retry, .task-state-badge.held {
  font-size: 0.8em;
  min-width: 0;
  background: none;
  border: none;
  padding: 0 0 0.2em 0;
  margin: none;
}
